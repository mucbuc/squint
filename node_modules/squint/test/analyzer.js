var assert = require( 'assert' )
  , Parser = require( 'squint/parser' ).Parser
  , Analyzer = require( 'squint/analyzer' ).Analyzer
  , events = require( 'events' );

namespace( '' );		// unnamed
namespace( 'test' );

function namespace( name ) {
  var emitter = new events.EventEmitter()
    , parser = new Parser( emitter )
    , analyzer = new Analyzer( emitter ); 
    
  function fail() {
    assert.fail( 'exit not expected', 'test run not complete' );
  }
  
  emitter.on( 'open namespace', function( code ) {
    assert.equal( code, name );    
    process.removeListener( 'exit', fail );
  } ); 
  
  process.on( 'exit', fail )
  parser.process( 'namespace ' + name + ' { text text; }' );
}